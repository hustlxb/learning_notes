# 树莓派

## pi账户密码

>user: pi  
passwd: pi123123  
root：lxb

**烧系统**

>格式化SD卡：SD Card Formatter  
>烧系统： Win32DiskImager
>>在内存卡中新建一个空白的ssh文件，连上路由器即可通过ssh连上树莓派

**连接小屏幕：**  
*config.txt 配置*

```shell
hdmi_drive=2
hdmi_group=2
hdmi_mode=87
hdmi_cvt 1024 600 60 0 0 0
```
**连接显示器：**  
*config.txt 配置*
```
hdmi_group=2
hdmi_mode=82
hdmi_ignore_edid=0xa5000080
```

**VNC连接树莓派**
sudo raspi-config 打开配置页面
扩展SD卡
打开SSH
打开VNC

[20篇精华案例玩转树莓派](http://jingyan.eeboard.com/article/75960)

**NCS主要的特点是针对深度学习中的图像和视频的处理**

>使用步骤：
使用运行Ubuntu/Debian的机器（或使用预先训练的网络）通过Tensorflow或Caffe培训网络。
使用NCS SDK生成graph文件
将graph文件和NCS部署到运行Linux（Debian）的单板计算机上，文章中是通过树莓派3B（基于Debian）实现的。
执行推理，分类，对象检测等

**软件工具主要包括了mvNCCompile、mvNCProfile以及mvNCCheck**：

>mvNCCompile是将Caffe/TF模型转换为NCS可识别的graph文件
mvNCProfile是提供每层的数据用于评估Caffe/TF网络模型在NCS上的运行效率，辅助开发者优化网络模型结构
mvNCCheck是通过在NCS和Caffe/TF上运行网络比较推断的结果

[Intel Movidius神经计算棒“疑难杂症”全解析](http://www.eeboard.com/evaluation/movisiudncsupdate/2/)

[Run NCS Applications on Raspberry Pi](https://movidius.github.io/blog/ncs-apps-on-rpi/)

>請改用已安裝完整SDK的開發用機器(桌上型/筆記型電腦)，並根據 mvNCCompile doc page 上的教學，以GoogLeNet 來產生graph檔。將開發機器上的 ~/workspace/ncsdk/examples/caffe/GoogLeNet/graph 複製到 Pi 的 ~/workspace/ncappzoo/caffe/GoogLeNet/graph路徑下。

**生成graph文件**

[mvNCCompile doc page](https://movidius.github.io/ncsdk/tools/compile.html)

**使用NCS进行图片分类**

[NCS image classifier ](https://movidius.github.io/blog/ncs-image-classifier/)

准备两个SD卡  一个装ubuntu16.04  完全版安装NCSDK
一个装Raspberry stretch

[树莓派装Ubuntu16.04](https://ubuntu-mate.org/raspberry-pi/)

```
sudo apt-get install gddrescue xz-utils
unxz ubuntu-mate-16.04.2-desktop-armhf-raspberry-pi.img.xz
sudo ddrescue -D --force ubuntu-mate-16.04.2-desktop-armhf-raspberry-pi.img /dev/sdx
```

**纯API模式安装NCSDK on Raspberry Pi**
1. Set up your Raspberry Pi in desktop mode
2. Install Debian and Python dependencies
```shell
sudo apt-get install -y libusb-1.0-0-dev libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libhdf5-serial-dev protobuf-compiler libatlas-base-dev git automake byacc lsb-release cmake libgflags-dev libgoogle-glog-dev liblmdb-dev swig3.0 graphviz libxslt-dev libxml2-dev gfortran python3-dev python-pip python3-pip python3-setuptools python3-markdown python3-pillow python3-yaml python3-pygraphviz python3-h5py python3-nose python3-lxml python3-matplotlib python3-numpy python3-protobuf python3-dateutil python3-skimage python3-scipy python3-six python3-networkx python3-tk

```
3. Download NCSDK onto your Pi
```shell
mkdir -p ~/workspace
cd ~/workspace
git clone https://github.com/movidius/ncsdk
```
4. Compile and install NCSDK’s API framework
```
cd ~/workspace/ncsdk/api/src
make
sudo make install
```
5. Test installation using sample code from NC App Zoo
Run the following commands in a terminal window:
```
cd ~/workspace
git clone https://github.com/movidius/ncappzoo
cd ncappzoo/apps/hello_ncs_py
python3 hello_ncs.py
```
You should see an output similar to:
```
Hello NCS! Device opened normally.
Goodbye NCS! Device closed normally.
NCS device working.
```
### Bonus step: Deploying a pre-compiled graph file
>The hello_ncs_py sample code we ran in step 5 opened the NCS device and closed it; it didn’t really run an inference. In order to run inference on NCS, we need a graph file that was generated by mvNCCompile, which is part of the NCSDK Toolkit we did not install on our Pi.

>Head over to your development machine where you have installed the full SDK, and follow the instructions from the mvNCCompile doc page to generate a graph file based on GoogLeNet. Copy ~/workspace/ncsdk/examples/caffe/GoogLeNet/graph from your development machine to ~/workspace/ncappzoo/caffe/GoogLeNet/graph of your Pi.

>Now that you have a graph file on your Pi, follow instructions from NCS image classifier to run an image classifier on your Pi.

### Further Experiments
>Run NCS image classifier on Raspberry Pi Compile and run a C/C++ sample code on RPi ex. ~/workspace/ncappzoo/apps/hello_ncs_cpp


### 使用虚拟机进行grub编译

#### virtual box启动usb3.0

**安装virtualbox extension pack**

>打开https://www.virtualbox.org/wiki/Downloads  
点击All supported platforms 下载  
安装VirtualBox Extension Pack  
`can not work... 识别不了usb3.0`

### 使用移动硬盘装了ubuntu16.04

>- NCSDK安装（均安装在了/opt/movidius/)
>- 英伟达显卡驱动安装
>- ssd-caffe对应的cuda安装

**cuda8.0安装**

```shell
sudo sh cuda_8.0.61_375.26_linux.run 
```

**Default Install Location of CUDA Toolkit**

Windows platform:

>%ProgramFiles%\NVIDIA GPU Computing Toolkit\CUDA\v#.#

Linux platform:

>/usr/local/cuda-#.#

Mac platform:

>/Developer/NVIDIA/CUDA-#.#

**Default Install Location of CUDA Samples**

Windows platform:

>%ProgramData%\NVIDIA Corporation\CUDA Samples\v#.#

Linux platform:

>/usr/local/cuda-#.#/samples  
`and`  
$HOME/NVIDIA_CUDA-#.#_Samples

Mac platform:

>/Developer/NVIDIA/CUDA-#.#/samples

**Toolkit Location**
 [ default is /usr/local/cuda-8.0 ]

```shell

===========
= Summary =
===========

Driver:   Not Selected
Toolkit:  Installed in /usr/local/cuda-8.0
Samples:  Installed in /home/lxb, but missing recommended libraries

Please make sure that
 -   PATH includes /usr/local/cuda-8.0/bin
 -   LD_LIBRARY_PATH includes /usr/local/cuda-8.0/lib64, or, add /usr/local/cuda-8.0/lib64 to /etc/ld.so.conf and run ldconfig as root

To uninstall the CUDA Toolkit, run the uninstall script in /usr/local/cuda-8.0/bin

Please see CUDA_Installation_Guide_Linux.pdf in /usr/local/cuda-8.0/doc/pdf for detailed information on setting up CUDA.

***WARNING: Incomplete installation! This installation did not install the CUDA Driver. A driver of version at least 361.00 is required for CUDA 8.0 functionality to work.
To install the driver using this installer, run the following command, replacing <CudaInstaller> with the name of this run file:
    sudo <CudaInstaller>.run -silent -driver

Logfile is /tmp/cuda_install_3680.log
```

**graph编译**

>mvNCCompile -o graph -w tiny-yolo-v1_53000.caffemodel -s 12 tiny-yolo-v1.prototxt

**ncappzoo examples**

目标识别（object detection)

birds:
Python
>Caffe Tiny Yolo, GoogLeNet
Detects and identifies birds in photos by using Yolo Tiny to identify birds in general and then GoogLeNet to further classify them. Displays images with overlayed rectangles bird classification.

stream_ty_gn:
Python
>Caffe Tiny Yolo, GoogLeNet
Sends frames of live camera stream to Tiny Yolo for object detection and then crops each object and sends that to GoogLeNet for further classification. This application requires two NCS devices, one for each network. Look at this example for straight forward example, but look at the threaded version if you are interested in better performance.

stream_ty_gn_threaded:
Python
>Caffe Tiny Yolo, GoogLeNet
Sends frames of live camera stream to Tiny Yolo for object detection and then crops each object and sends that to GoogLeNet for further classification. This application requires two NCS devices, one for each network. This is a threaded, better performing, and slightly more complex version of the stream_ty_gn application.

street_cam:
Python
>Caffe TinyYolo, GoogLeNet
Processes a video file (presumably produced by a street camera) and overlays boxes and labels around the objects detected. Objects are detected by Tiny Yolo and then further classified by GoogLeNet. This requires two NCS devices. Look at this example for straight forward example, but look at the threaded version if you are interested in better performance.

street_cam_threaded:
Python
>Caffe TinyYolo, GoogLeNet
Processes a video file (presumably produced by a street camera) and overlays boxes and labels around the objects detected. Objects are detected by Tiny Yolo and then further classified by GoogLeNet. This requires two NCS devices. This is a threaded, better performing, and more complex version of the street_cam application.

video_objects:
Python
>Caffe SSD MobileNet
Processes a video file and overlays boxes and labels around the objects detected and displays results in a GUI as frames are available.


## 安装NCSDK 经验
```sh
unzip ncsdk-master.zip

cd ncsdk-master

make install 
# 安装所需要的库 opencv等
make examples

遇到error: no suitalbe plugin 
sudo apt-get install python3-tk

unzip ncapzoo-master.zip
cd ncapzoo-master

cd apps

make 
python3 video_objects.py
```


